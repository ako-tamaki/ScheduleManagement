一、实验目的
理解预测分析表法的基本原理，掌握LL(1)文法的分析方法。

实现基于预测分析表法的语法分析程序，能够根据输入的LL(1)文法自动构建预测分析表。

对输入的字符串进行语法分析，输出分析过程，验证其是否符合文法规则。

二、概要设计（总体设计思想）
1. 核心算法
本实验采用预测分析表法进行语法分析，主要步骤包括：

计算FIRST集：确定每个非终结符能推导出的首个终结符。

计算FOLLOW集：确定每个非终结符后可能跟随的终结符。

构建预测分析表：根据FIRST和FOLLOW集填充分析表，确定每个非终结符在遇到某个终结符时应采用的产生式。

分析输入字符串：利用分析表进行移进-规约分析，输出分析过程。

2. 数据结构
文法存储：采用Grammar结构体存储非终结符、终结符、产生式和开始符号。

FIRST/FOLLOW集：使用map<string, set<string>>存储。

预测分析表：使用map<pair<string, string>, vector<string>>存储，键为(非终结符, 终结符)，值为对应的产生式右部。

3. 程序流程
用户输入文法（非终结符、终结符、产生式）。

计算FIRST集和FOLLOW集。

构建预测分析表并输出。

用户输入待分析的字符串。

程序进行语法分析，输出分析过程。

三 详细设计
1.程序主流程
graph TD
    A[开始] --> B[输入文法]
    B --> C[计算FIRST集]
    C --> D[计算FOLLOW集]
    D --> E[构建预测分析表]
    E --> F[输出分析表]
    F --> G[输入待分析字符串]
    G --> H[执行语法分析]
    H --> I[输出分析过程]
    I --> J[结束]

2.自动机的存储格式
    struct Grammar {
    vector<string> nonTerminals;    // 非终结符
    vector<string> terminals;       // 终结符
    map<string, vector<vector<string>>> productions; // 产生式
    string startSymbol;             // 开始符号
};
map<string, set<string>> first;  // FIRST集
map<string, set<string>> follow; // FOLLOW集
map<pair<string, string>, vector<string>> parsingTable;

3.关键函数流程图
(1)计算FIRST集
graph TD
    A[初始化终结符的FIRST集] --> B[初始化非终结符的FIRST集为空]
    B --> C[遍历所有产生式]
    C --> D[计算FIRST(α)]
    D --> E[若α可推导出ε, 加入FOLLOW(A)]
    E --> F[更新FIRST集]
    F --> G{是否仍有变化?}
    G -- 是 --> C
    G -- 否 --> H[返回FIRST集]
(2)计算FOLLOW集
graph TD
    A[初始化FOLLOW集] --> B[开始符号加入#]
    B --> C[遍历所有产生式]
    C --> D[对每个非终结符B]
    D --> E[若B后有符号, 加入FIRST(β)]
    E --> F[若β可推导出ε, 加入FOLLOW(A)]
    F --> G[更新FOLLOW集]
    G --> H{是否仍有变化?}
    H -- 是 --> C
    H -- 否 --> I[返回FOLLOW集]
(3)构建预测分析表
graph TD
    A[遍历所有产生式] --> B[计算FIRST(α)]
    B --> C[对FIRST(α)中的每个终结符a, 加入M[A,a]]
    C --> D[若ε∈FIRST(α), 对FOLLOW(A)中的每个b, 加入M[A,b]]
    D --> E[返回预测分析表]
(4)语法分析过程
graph TD
    A[初始化栈: #, 开始符号] --> B[读取输入符号a]
    B --> C{栈顶X是终结符或#?}
    C -- 是 --> D{匹配?}
    D -- 是 --> E[弹出X, 读取下一个符号]
    D -- 否 --> F[报错]
    C -- 否 --> G[查找M[X,a]]
    G --> H{存在产生式?}
    H -- 是 --> I[弹出X, 压入产生式右部]
    H -- 否 --> J[报错]
    I --> B
    E --> B
    K[栈空且输入结束] --> L[分析成功]

四 结果分析
1.输入与输出结果
2.存在问题及改进方向
错误处理不足：当前程序在遇到错误时直接终止，可改进为尝试恢复或提供更详细的错误信息。
仅支持LL(1)文法：无法处理左递归或二义性文法，可扩展支持更复杂的分析方法（如LR分析）。
输入限制：目前要求用户严格按格式输入，可增加输入校验和容错机制

3.实验心得
通过本次实验，深入理解了LL(1)文法的分析方法，掌握了FIRST集、FOLLOW集的计算方法。
预测分析表的构建过程让我更加熟悉自动机在编译原理中的应用。
调试过程中遇到栈匹配错误的问题，通过逐步打印分析过程解决了该问题，增强了对语法分析流程的理解。

五 结论
本实验成功实现了基于预测分析表法的语法分析程序，能够正确构建LL(1)文法的预测分析表，并对输入字符串进行语法分析。程序结构清晰，关键算法正确，为进一步研究编译技术奠定了基础。